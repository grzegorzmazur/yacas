<html>
  <head>
    <link rel="stylesheet" href="yacas.css" TYPE="text/css" MEDIA="screen">
    <script type="text/javascript" src="datahub.js"></script>
    <script type="text/javascript" src="yacas.js"></script>
  </head>
  <body>

    <script type="text/javascript">

var current = 0;

var previousValue = "";

function nextStep()
{
  var thetable = document.getElementById("thetable");

  var result;
  var toshow;
  var end = 0;
  var totalend = 0;
  if (current == 0)
  {
    result = ""+yacas_calculate("start();");
    toshow = result;
    end = 0;
    totalend = -1;
  }
  else
  {
    result = ""+yacas_calculate("iterate();");
    if (result.length > 51)
      result = result.substring(0,51);
    toshow = result;

    end = result.length;
    totalend = end;
    if (previousValue.length < end) end = previousValue.length;
    while (end > 0)
    {
      if (result.substring(0,end) == previousValue.substring(0,end))
      {
        break;
      }
      end--;
    }
    if (end > 0)
    {
      toshow = '<tt style="color:red; ">'+previousValue.substring(0,end)+'</tt>'+previousValue.substring(end);
    }
  }
  previousValue = result;
  if (current > 0)
    thetable.innerHTML = thetable.innerHTML + "<div>"+toshow+"</div>";

  if ( (totalend != end) && (current < 15) )
  {
    current = current + 1;
    setTimeout("nextStep()",100);
  }
  else
  {
    thetable.innerHTML = thetable.innerHTML + '<input type="button" value="Restart" onclick="enterInput();"/>';
  }
}

function restart()
{
  if (getConsoleApplet() == null) return;
  var elem;

  elem = document.getElementById("function");
  var fn = elem.value;

  elem = document.getElementById("initValue");
  var initValue = elem.value;

  elem = document.getElementById("precision");
  var precision = elem.value;

  var thetable = document.getElementById("thetable");
  thetable.innerHTML = "Trying to find x where "+fn+" = 0 through Newton iteration, starting at x="+initValue+" at precision "+precision;
  current = 0;
  setTimeout("nextStep()",100);
}

function enterInput()
{
  var consoleApplet = document.consoleApplet;
  if (!consoleApplet)
    consoleApplet = parent.document.consoleApplet;
  if (consoleApplet)
  {
    if (consoleApplet.isActive)
      if (!consoleApplet.isActive())
      {
        setTimeout("enterInput();",1000);
        return;
      }
  }

  var thetable = document.getElementById("thetable");
  thetable.innerHTML = "<input id='function' type='text' value='Sin(x)' /> = 0, with x starting at <input id='initValue' type='text' value='3' /><input type='button' value='Go' onclick='restart();'/> <br />Precision: <input id='precision' type='text' value='50' /> digits.";
}

var prevOnload = window.onload;

window.onload = init;

function init()
{
  if (prevOnload)
    prevOnload();
  enterInput();
}

    </script>




    <div style="padding: 2px 2px 2px 2px; border: 1px solid #000000;">
      <pre><div id="thetable">Please wait, loading application...</div></pre>
    </div>

<applet name="consoleApplet" archive="yacas.jar" code="net.sf.yacas.ConsoleApplet" width=1 height=1>
  <param name="programMode" value="journal">
  <param name="progressbar" value="true">
  <param name="boxmessage" value="Loading Yacas...">
  <param name="init1" value="Load(''yacasinit.ys'')">
  Your browser does not support Java, so nothing is displayed.
</applet>

<APPLET name="datahub" archive="yacas.jar" code="net.sf.yacas.DatahubApplet" width=1 height=1>
<PARAM name="programMode" value="journal">
<PARAM name="articleFromFile" value="newtonconvergence.yart">
</APPLET>


  </body>
</html>
