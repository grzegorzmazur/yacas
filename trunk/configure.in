# Process this file with autoconf to produce a configure script.
AC_INIT(src/yacasmain.cpp)
AM_CONFIG_HEADER(config.h)

PACKAGE=yacas
MAJOR=1
MINOR=0
MICRO=47rev1
RELEASE=1

VERSION=$MAJOR.$MINOR.$MICRO
AM_INIT_AUTOMAKE($PACKAGE, $VERSION)
AC_SUBST(RELEASE)

# Checks for programs.
AC_PROG_CC
AC_PROG_CPP
AC_PROG_CXX
AC_PROG_RANLIB

# Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS(unistd.h sys/ioctl.h sys/socket.h sys/time.h sys/types.h)

# Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_C_INLINE
AC_HEADER_TIME

# Checks for library functions.
AC_CHECK_FUNCS(select socket strtod)

# checks for libraries
AC_CHECK_LIB(dl,dlopen,LIBS="$LIBS -ldl -rdynamic",,-rdynamic)

AC_FUNC_ACCEPT_ARGTYPES
TYPE_SOCKLEN_T


# Choice of arbitrary precision library
AC_ARG_ENABLE(gmp, [  --enable-gmp            use GNU MP [default=no]])
if test "$enable_gmp" = "yes" ; then
	AC_CHECK_LIB(gmp, mpz_init, have_gmp=yes, have_gmp=no)
	if test "$have_gmp" = "no" ; then
		AC_MSG_ERROR([GNU MP library not found])
	fi
	NUMBERS_LIB="libgmpnumbers.a"
	NUMBERS_LDFLAGS="-lgmp -lm"
else
	NUMBERS_LIB="libyacasnumbers.a"
	NUMBERS_LDFLAGS="-lm"
fi
AC_SUBST(NUMBERS_LIB)
AC_SUBST(NUMBERS_LDFLAGS)

# Choice of script directory
AC_ARG_WITH(script-dir, [  --with-script-dir=DIR   program scripts in DIR [DATADIR/yacas]])
if test -n "$with_script_dir" ; then
	scriptdir=$with_script_dir
else
	scriptdir=${datadir}/yacas/
fi
AC_SUBST(scriptdir)

# All done
AC_OUTPUT(yacas.spec
	Makefile
	docs/Makefile
	inprogress/Makefile
	proteus/Makefile
	YacasNotebook/Makefile
	manualmaker/Makefile
	plugins/Makefile
	scripts/Makefile
	colorcode/Makefile
	ramscripts/Makefile
	tests/Makefile
	src/Makefile)
