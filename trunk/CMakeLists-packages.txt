if (WIN32)
  install (FILES /usr/lib/gcc/i686-w64-mingw32/4.9-win32/libgcc_s_sjlj-1.dll /usr/i686-w64-mingw32/lib/libwinpthread-1.dll DESTINATION bin COMPONENT app)
endif ()

if (APPLE)
  set (CPACK_SET_DESTDIR TRUE) #framework goes to /Library/frameworks without Access Denied during compilation, better calculating size in installer
endif ()

set (CPACK_DEB_COMPONENT_INSTALL on)
set (CPACK_COMPONENTS_IGNORE_GROUPS 1)
set (CPACK_COMPONENTS_ALL app doc dev)
set (CPACK_COMPONENTS_GROUPING ONE_PER_GROUP)

if (${CMAKE_SYSTEM_NAME} STREQUAL "Linux")
  set (CPACK_GENERATOR DEB)
  set (CPACK_DEBIAN_PACKAGE_ARCHITECTURE "amd64")
elseif (WIN32 AND NOT UNIX)
  set (CPACK_GENERATOR NSIS)
  set (CPACK_NSIS_MODIFY_PATH "ON")
  set (CPACK_NSIS_ENABLE_UNINSTALL_BEFORE_INSTALL "ON")
  set (CPACK_NSIS_HELP_LINK "http://yacas.sourceforge.net/")
  set (CPACK_NSIS_URL_INFO_ABOUT "http://yacas.sourceforge.net/")
  set (CPACK_NSIS_MUI_ICON "${PROJECT_SOURCE_DIR}/res/yacas.ico")
  set (CPACK_NSIS_INSTALLED_ICON_NAME "bin\\\\yacas.exe")
  set (CPACK_CREATE_DESKTOP_LINKS "yacas.exe" "yacas")
endif ()

set (CPACK_PACKAGE_NAME "yacas")
set (CPACK_PACKAGE_VENDOR "yacas")
set (CPACK_PACKAGE_CONTACT "yacas-devel@lists.sourceforge.net")
set (CPACK_PACKAGE_DESCRIPTION_SUMMARY "YACAS is an easy to use, general purpose computer algebra system.")
set (CPACK_PACKAGE_DESCRIPTION_FILE "${PROJECT_SOURCE_DIR}/README")

if(APPLE)
  configure_file(
    "${PROJECT_SOURCE_DIR}/COPYING"
    "${PROJECT_BINARY_DIR}/COPYING.txt"
    @ONLY)
  configure_file(
    "${PROJECT_SOURCE_DIR}/README"
    "${PROJECT_BINARY_DIR}/README.txt"
    @ONLY)
  set (CPACK_RESOURCE_FILE_LICENSE "${PROJECT_BINARY_DIR}/COPYING.txt")
  set (CPACK_RESOURCE_FILE_README "${PROJECT_BINARY_DIR}/README.txt")
else()
  set (CPACK_RESOURCE_FILE_LICENSE "${PROJECT_SOURCE_DIR}/COPYING")
  set (CPACK_RESOURCE_FILE_README "${PROJECT_SOURCE_DIR}/README")
endif()

set (CPACK_PACKAGE_VERSION ${YACAS_VERSION})
set (CPACK_PACKAGE_VERSION_MAJOR ${YACAS_VERSION_MAJOR})
set (CPACK_PACKAGE_VERSION_MINOR ${YACAS_VERSION_MINOR})
set (CPACK_PACKAGE_VERSION_PATCH ${YACAS_VERSION_MICRO})
set (CPACK_PACKAGE_INSTALL_DIRECTORY "yacas")
set (CPACK_PACKAGE_EXECUTABLES yacas;Yacas)

set(CPACK_COMPONENT_APP_DISPLAY_NAME "Yacas")
set(CPACK_COMPONENT_DOC_DISPLAY_NAME "Documentation")
set(CPACK_COMPONENT_DEV_DISPLAY_NAME "Development")

include (CPack)
