<html>
  <head>
    <link rel="stylesheet" href="yacas.css" TYPE="text/css" MEDIA="screen">
    <script type="text/javascript" src="datahub.js"></script>
    <script type="text/javascript" src="yacas.js"></script>

    <script type="text/javascript">
      /* When deep link found, redirect to the tabbified main page */
      if (top.location == self.location)
      {
        self.location.replace("homepage.html?recent.html&newtonconvergence.html");
      }
    </script>

    <script type="text/javascript">

var current = 0;
var previousValue = "";
var usedPrecision = "50";
var initValue = "3";
var usedFn = "Sin(x)";

function nextStep()
{
  var thetable = document.getElementById("thetable");

  var result;
  var toshow;
  var end = 0;
  var totalend = false;
  if (current == 0)
  {
    result = ""+yacas_calculate("start();");
    toshow = result;
    end = 0;
    totalend = false;
  }
  else
  {
    result = ""+yacas_calculate("iterate();");
    toshow = result;
    end = result.length;
    totalend = false;
    if (previousValue.length < end) end = previousValue.length;
    while (end > 0)
    {
      if (result.substring(0,end) == previousValue.substring(0,end))
      {
        break;
      }
      end--;
    }
    if (end > 0)
    {
      if (current > 5 && previousValue.length == end && end >= usedPrecision)
      {
        totalend = true;
      }
      toshow = '<tt style="color:red; ">'+previousValue.substring(0,end)+'</tt>'+previousValue.substring(end);
    }
  }
  previousValue = result;
  thetable.innerHTML = thetable.innerHTML + "<div>x("+current+") = "+toshow+"</div>";

  if ( totalend == false && (current < 15) )
  {
    current = current + 1;
    setTimeout("nextStep()",100);
  }
  else
  {
    thetable.innerHTML = thetable.innerHTML + '<input type="button" value="Change" onclick="enterInput();"/> <input type="button" value="Other example" onclick="goNextExample();"/>';
  }
}

function goNextExample()
{
  example();
  restart();
}

function restart()
{
  if (getConsoleApplet() == null) return;
  var elem;

  elem = document.getElementById("function");
  usedFn = elem.value;

  yacas_calculate("[Clear(x);setup("+usedFn+");];");

  elem = document.getElementById("initValue");
  initValue = elem.value;
  yacas_calculate("newtonInitValue := "+initValue+";");

  elem = document.getElementById("precision");
  usedPrecision = elem.value;
  yacas_calculate("newtonPrecision := "+usedPrecision+";");

  var thetable = document.getElementById("thetable");
  thetable.innerHTML = "Trying to find x where "+usedFn+" = 0 through Newton iteration, starting at x="+initValue+" at precision "+usedPrecision+
  "<br /> <div id='iter'><input type='button' value='Show iteration equation' onclick='showIterExpr();' /> </div>";

  current = 0;
  setTimeout("nextStep()",100);
}

function showIterExpr()
{
  var elem = document.getElementById("iter");
  var iterStr = yacas_calculate("[Local(x);TeXForm(x_(i+1) == newtonIteration(x_i) );];");
  iterStr = iterStr.substring(2,iterStr.length()-2);
  elem.innerHTML = 
    '<applet code=net.sf.yacas.FormulaViewApplet archive="yacas.jar" width=400 height=100>'+
    '  <param name="expression" value="'+iterStr+'" />'+
    '</applet><br />';
}

function enterInput()
{
  var consoleApplet = document.consoleApplet;
  if (!consoleApplet)
    consoleApplet = parent.document.consoleApplet;
  if (consoleApplet)
  {
    if (consoleApplet.isActive)
      if (!consoleApplet.isActive())
      {
        setTimeout("enterInput();",1000);
        return;
      }
  }

  var thetable = document.getElementById("thetable");
  thetable.innerHTML = "<input id='function' type='text' value='"+usedFn+"' /> = 0, with x starting at <input id='initValue' type='text' value='"+initValue+"' /><input type='button' value='Go' onclick='restart();'/> <input type='button' value='Other example' onclick='example();'/> <br />Precision: <input id='precision' type='text' value='"+usedPrecision+"' /> digits.";
}

var exPrecisions = new Array('80'   ,'80'    , '80');
var exInitValues = new Array('3'     ,'1'    , '2');
var exFunctions  = new Array('Sin(x)','x^2-2', 'Ln(x)-1');
var curExample = 0;

function example()
{
  usedPrecision = exPrecisions[curExample];
  initValue     = exInitValues[curExample];
  usedFn        = exFunctions [curExample];
  curExample = (curExample+1) % exFunctions.length;
  enterInput();
}

var prevInit = window.onload;

window.onload = init;

function init()
{
  if (prevInit)
  {
    prevInit();
  }
  example();
}

    </script>
  </head>
  <body>
    <h1>A demonstration of the amazingly fast convergence of Newton iteration</h1>

    <div style="padding: 2px 2px 2px 2px; border: 1px solid #000000;">
      <pre><div id="thetable">Please wait, loading application...</div></pre>
    </div>

    <p>
When trying to find something, one would usually want to work efficiently, so one can find what one is looking for as quickly as possible. For example, you probably know the game where you have to guess a number under say a hundred, and where you get an indication "higher" or "lower" for each guess you make. The trick with this game is to always guess in the middle of the range known to contain the solution, so the chance that the number you are guessing at is higher is equal to the chance that the number is lower, thus halving the range with each answer. This ensures that you arrive at the correct answer in the least possible steps, on average (if this is all the information you are given).
    </p>
    <p>
The method of searching by guessing in the middle of the possible solutions is called a binary search (or sometimes the bisection method), and is often a very good approach when trying to find something. It can be proven from information theory that the answer to a question with two possible answers, each with a 50 percent chance, gives you maximum information. This is the theoretical basis for the binary search approach; when you have no additional knowledge of the object you are trying to find, a binary search is usually the quickest approach. The speed with which you gather information with a binary search grows linearly with the number of questions you ask. Each time you get an answer, you have another bit of information, while maximizing the information content of the answer to each question. In contrast, the answer to a question where the odds that the answer is yes is 99 percent and the odds that the answer is no is 1 percent, gives much less information. You already knew that the answer was likely to be yes, so you get very little extra information.  
    </p>
    <p>
There are situations where binary search is not the best approach, and finding the zero of a smooth continuous function is one such example. For finding a zero, Newton iteration will usually outshine binary search, and it is not even a close call. The reason finding a zero of an analytic function is better done through Newton iteration is that with a smooth continuous function one <em>does</em> have more information, namely the derivative of the function! The function, together with its derivative, can be used in an ingenious way to not just determine the direction one has to consider for the zero, but also to determine an estimate of the <em>distance</em> to the final solution. 
    </p>

    <p>
The speed of convergence of Newton iteration can sometimes be nothing short of astounding. It will often happen, for suitably neatly defined problems, that the amount of information you gather doubles with each question you ask! Or even triples! Imagine having an encyclopedia, where the number of volumes you have doubles each time you put in some effort to get new information (by finding the answer to a question). Each time you get an answer to a question, you double the number of words of information you have. You can see this happen in the demonstration at the top of this article, where the digits in red indicate correct digits, and black are as of yet incorrect digits. With the typical example, the number of digits precision doubles or triples, with each iteration. This is very far off from the application of binary search, where you get one extra bit of information in a linear fashion, each time you ask a question.
    </p>

    <p>
Here is the math behind Newton iteration; we start with a function <tt>f(x)</tt>, and start at some value <tt>x0</tt>, and take a first-order Taylor series expansion as an approximation of the function:
    </p>
    <p>

<div class="math">
f \left( x \right) = f \left( x_0 \right) + \left( x - x_0 \right) \frac{d f(x)}{dx}
</div>
    </p>
    <p>
We thus effectively approximate the function with a straight line. The shorter the distance (the nearer x is to x0), the more correct that approximation will be. This method thus only works well when the initial guess x0 is close to the real answer.
    </p>
    <p>
We want the function f(x1) to be zero, so setting it to zero yields:
    </p>
    <p>
<div class="math">
f \left( x_0 \right) + \left( x_1 - x_0 \right) \frac{d f(x)}{dx} = 0
</div>
    </p>
    <p>
Or:
    </p>
    <p>
<div class="math" style="height:160px; ">
x_1 = x_0 - \frac{f \left( x_0 \right) }{ \left[ \frac{d f \left( x_0 \right) }{dx} \right] }
</div>
    </p>
    <p>
Repeating this for x1 to x2 and so on should yield more and more accurate answers. 
    </p>
    <p>
We will now try this out on a simple example. We will try to get the zero 
<tt>Sin(x)=0</tt> for x at pi (thus effectively approximating the value of pi). The derivative of <tt>Sin(x)</tt> with respect to x is <tt>Cos(x)</tt>, so the above expression becomes:
    </p>
    <p>
<div class="math" style="height:160px; ">
x_1 = x_0 - \frac{sin \left( x_0 \right) }{cos \left( x_0 \right) }
</div>
    </p>
    <p>
Or
    </p>
    <p>
<div class="math">
x_1 = x_0 - tan \left( x_0 \right)
</div>
    </p>
    <p>
The demonstration at the top of this article shows the result of applying Newton iteration to a few examples. For each iteration it shows the current result, where the digits in red are the digits that are already correct, the black ones are not correct yet. This demonstration is really using Yacas, so you can insert real examples to try out yourself.
    </p>

    <p>
You can view the Yacas script code used in this example <a href="journaldescr.html?newtonconvergence">here</a>.
    </p>


<applet name="consoleApplet" archive="yacas.jar" code="net.sf.yacas.ConsoleApplet" width=1 height=1>
  <param name="programMode" value="journal">
  <param name="progressbar" value="true">
  <param name="boxmessage" value="Loading Yacas...">
  <param name="init1" value="Load(''yacasinit.ys'')">
  Your browser does not support Java, so nothing is displayed.
</applet>

<applet name="datahub" archive="yacas.jar" code="net.sf.yacas.DatahubApplet" width=1 height=1>
  <param name="programMode" value="journal">
  <param name="articleFromFile" value="newtonconvergence.yart">
</applet>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2425144-1";
urchinTracker();
</script>

  </body>
</html>

