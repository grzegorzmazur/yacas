/* Numerical testers - all confirmed with Matlab 6r12.0 */
Precision(10);

Verify( RoundTo(N(Sec(2)), 9), -2.402997962);
Verify( RoundTo(N(Csc(2)), 9),  1.09975017);
Verify( RoundTo(N(Cot(2)), 9), -0.457657554);
Verify( RoundTo(N(Sinh(2)), 9), 3.626860408);

Verify( RoundTo(N(ArcSin(2)), 9), Complex(1.570796327,1.316957897));
Verify( RoundTo(N(ArcCos(2)), 9), Complex(0,-1.316957897));
Verify( RoundTo(N(ArcTan(2*I)), 9), Complex(1.570796327,0.549306144));
Verify( RoundTo(N(ArcSinh(2)), 9), 1.443635475);
Verify( RoundTo(N(ArcCosh(2)), 9), 1.316957897);
TestYacas( RoundTo(N(ArcCosh(-2)), 8), Complex(-1.3169579,3.14159265));
Verify( RoundTo(N(ArcTanh(2)), 9), Complex(0.549306144,1.570796327));

/* Numerical tests - all confirmed with Maple */
Precision(50);

Verify(
RoundTo(N(Pi), 50)
, 3.1415926535897932384626433832795028841971693993751
);

Verify(
RoundTo(N(Sin(2.0)), 49)
, 0.9092974268256816953960198659117448427022549714479
);

Verify(
RoundTo(N(Sin(2.0)), 50)
, 0.90929742682568169539601986591174484270225497144789
);

Verify(
RoundTo(N(Sin(2.0)), 51)
, 0.90929742682568169539601986591174484270225497144789
);

Verify(
RoundTo(N(Cos(20.0)), 49)
, 0.4080820618133919860622678609276449570992995103162
);

Verify(
RoundTo(N(Tan(20.0)), 49)
, 2.2371609442247422652871732477303491783724839749188
);

Verify(
RoundTo(N(Exp(10.32)), 48)
, 30333.257596224603560034348335010962177837648633545013
);

Verify(
RoundTo(N(Ln(10.32/4.07)), 49)
, 0.93044076059891305468974486564632598071134270468
);

Verify(
RoundTo(N(1.3^10.32), 48)
, 14.99323664825717956473936947123246987802978985306
);

Verify(
RoundTo(N(Sqrt(5.3)), 50)
, 2.30217288664426764419484158642020185018583028263367
);

Verify(
RoundTo([x:=Newton(x*Exp(x)-4,x,1,10^(-49)); N(x*Exp(x));], 49)
, 4
);
Verify(Newton(x^2+1,x,1,0.1,-3,3), Fail);
Verify(Newton(x^2-1,x,1,0.1,-3,3), 1);

Verify(
RoundTo(N(ArcSin(0.32)), 49)
, 0.3257294872946301593103199105324500784354180998123
);

Verify(
RoundTo(N(Sin(N(ArcSin(0.1234567)))), 49)
, 0.1234567
);

/* ArcSin(x) for x close to 1 */

Verify(
RoundTo(N( (1-Sin(N(ArcSin(1-10^(-25)))))*10^25), 25)
, 1
);

Verify(
RoundTo(N(ArcSin(N(Sin(1.234567)))), 49)
, 1.234567
);

Verify(
RoundTo(N(ArcCos(0.32)), 49)
, 1.2450668395002664599210017811073013636631665998753
);

Verify(
RoundTo(N(ArcTan(0.32)), 49)
, 0.3097029445424561999173808103924156700884366304804
);

Verify(
RoundTo(N(Cos(N(ArcCos(0.1234567)))), 49)
, 0.1234567
);

Verify(
RoundTo(N(ArcCos(N(Cos(1.234567)))), 49)
, 1.234567
);

Verify(
RoundTo(N(Tan(N(ArcTan(20)))), 46)	// large roundoff error on Tan() calculation due to subtraction from Pi/2 -- unavoidable loss of precision
, 20
);
//KnownFailure(
Verify(
RoundTo(N(Tan(N(ArcTan(500000)))), 38)
, 500000
//)
);

//KnownFailure(
Verify(
RoundTo(N((Pi/2-ArcTan(N(Tan(N(Pi/2)-10^(-24)))))*10^24 ), 25)
, 1
//)
);

/// special functions
Precision(20);	// let's be gentle

TestYacas(
Gamma(10.5)
, (654729075*Sqrt(Pi))/1024
);

TestYacas(
Gamma(9/2)
, (105*Sqrt(Pi))/16
);

TestYacas(
Gamma(-10.5)
, (-2048*Sqrt(Pi))/13749310575
);

TestYacas(
Gamma(-7/2)
, (16*Sqrt(Pi))/105
);

TestYacas(
RoundTo(N( GammaNum(10.5) ), 13)
, 1133278.3889487855673
);

TestYacas(
RoundTo(N( GammaNum(-11.5) ), 20)
, 0.00000002295758104824
);

TestYacas(
RoundTo(N( GammaNum(-12.5) ), 20)
, -0.00000000183660648386
);

TestYacas(	// lost 2 digits b/c of imprecise arithmetic
RoundTo(N( Zeta(-11.5) ), 18)
, 0.020396978715942792
);

TestYacas(
Zeta(40)
, (261082718496449122051*Pi^40)/20080431172289638826798401128390556640625
);

TestYacas(
Zeta(-11)
, 691/32760
);

TestYacas(
Zeta(-12)
, 0
);

TestYacas(
RoundTo(ZetaNum(40), 19)
, 1.0000000000009094948
);

TestYacas(
RoundTo(ZetaNum(1.5), 19)
, 2.6123753486854883433
);

// test correctness of Zeta(3)
Verify(
RoundTo(ZetaNum(3)-N(Zeta(3)), 20)
, 0
);

TestYacas(
Bernoulli(40)
, -261082718496449122051/13530
);

Verify(
ContFracList(355/113)
, {3,7,16}
);

Verify(
ContFracList(-24, 4)
, {-24}
);

Verify(
ContFracList(-355/113)
, {-4,1,6,16}
);

Precision(7);

Verify(
GuessRational(N(Pi))
, 355/113
);
Precision(10);
Verify(
NearRational(N(Pi))
, 355/113
);

// Lambert's W function
Verify(
N(LambertW(-0.24))
, -0.3357611648
);
Verify(
N(LambertW(10))
, 1.7455280027
);

// Bessel Functions
// These results are from GNU bc, matlab seems to suck.
Precision(50);
Verify( N(BesselJ(0,.5)), RoundTo(.93846980724081290422840467359971262556892679709682,50) );
Verify( N(BesselJ(0,.9)), RoundTo(.80752379812254477730240904228745534863542363027564,50) );
Verify( N(BesselJ(0,.99999)), RoundTo(.76520208704756659155313775543958045290339472808482,50) );
Verify( N(BesselJ(10,.75)), RoundTo(.00000000001496217131175968146987124836216828348578,50) );
Verify( N(BesselJ(5,1)), RoundTo(.00024975773021123443137506554098804519815836777698,50) );
Verify( N(BesselJ(4,2)), RoundTo(.03399571980756843414575921128853104471483296834631,50) );
Verify( N(BesselJ(10,3)), RoundTo( .00001292835164571588377753453080258017074342083284,50) );

Verify( N(BesselJ(11,11)), RoundTo( .20101400990926940339478738551009382430831534125484,50) );
Verify( N(BesselJ(-11,11)), RoundTo( -.20101400990926940339478738551009382430831534125484,50) );
Verify( N(BesselJ(1,10)), RoundTo( .04347274616886143666974876802585928830627286711859, 50) );
Verify( N(BesselJ(10,10)), RoundTo( .20748610663335885769727872351875342803274461128682, 50 ) );
Verify( N(BesselJ(1,3.6)), RoundTo( .09546554717787640384570674422606098601943275490885, 50 )) ;

Precision(20);
Verify( N(Erf(Sqrt(0.8))), // verified with Maple
RoundTo(.79409678926793169113034892342, 19)
);
Verify( RoundTo(N(Erf(50*I+20)/10^910),19), // verified with Maple
RoundTo(1.09317119002909585408+I*0.00475463306931818955275, 19)
);

// testing GammaConstNum against Maple
Testing("Gamma constant");
Precision(40);
Verify(gamma()+0, 0.5772156649015328606065120900824024310422);
Precision(20);
Verify(gamma,Atom("gamma"));
Verify(gamma()+0, 0.5772156649015328606);
Verify(RoundTo(N(1/2+gamma+Pi), 19), 4.2188083184913260991);

// From GSL 1.0
Verify( RoundTo(N(PolyLog(2,-0.001)),20), -0.00099975011104865108 );

