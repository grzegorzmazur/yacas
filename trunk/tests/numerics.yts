/* Numerical testers - all confirmed with Matlab 6r12.0 */
Precision(10);

Verify( RoundTo(N(Sec(2)), 9), -2.402997962);
Verify( RoundTo(N(Csc(2)), 9),  1.09975017);
Verify( RoundTo(N(Cot(2)), 9), -0.457657554);
Verify( RoundTo(N(Sinh(2)), 9), 3.626860408);

Verify( RoundTo(N(ArcSin(2)), 9), Complex(1.570796327,1.316957897));
Verify( RoundTo(N(ArcCos(2)), 9), Complex(0,-1.316957897));
Verify( RoundTo(N(ArcTan(2*I)), 9), Complex(1.570796327,0.549306144));
Verify( RoundTo(N(ArcSinh(2)), 9), 1.443635475);
Verify( RoundTo(N(ArcCosh(2)), 9), 1.316957897);
Verify( RoundTo(N(ArcCosh(-2)), 9), Complex(-1.316957897,3.141592654));
Verify( RoundTo(N(ArcTanh(2)), 9), Complex(0.549306144,1.570796327));

/* Numerical tests - all confirmed with Maple */
Precision(50);

Verify(
RoundTo(N(Pi), 50)
, 3.1415926535897932384626433832795028841971693993751
);

Verify(
RoundTo(N(Sin(2.0)), 49)
, 0.9092974268256816953960198659117448427022549714479
);

Verify(
RoundTo(N(Sin(2.0)), 50)
, 0.90929742682568169539601986591174484270225497144789
);

Verify(
RoundTo(N(Sin(2.0)), 51)
, 0.90929742682568169539601986591174484270225497144789
);

Verify(
RoundTo(N(Cos(20.0)), 49)
, 0.4080820618133919860622678609276449570992995103162
);

Verify(
RoundTo(N(Tan(20.0)), 49)
, 2.237160944224742265287173247730349178372483974919
);

Verify(
RoundTo(N(Exp(10.32)), 48)
, 30333.257596224603560034348335010962177837648633545013
);

Verify(
RoundTo(N(Ln(10.32/4.07)), 49)
, 0.93044076059891305468974486564632598071134270468
);

Verify(
RoundTo(N(1.3^10.32), 48)
, 14.993236648257179564739369471232469878029789853061
);

Verify(
RoundTo(N(Sqrt(5.3)), 50)
, 2.30217288664426764419484158642020185018583028263367
);

Verify(
RoundTo([x:=Newton(x*Exp(x)-4,x,1,10^(-49)); N(x*Exp(x));], 49)
, 4
);

Verify(
RoundTo(N(ArcSin(0.32)), 49)
, 0.3257294872946301593103199105324500784354180998123
);

KnownFailure(
Verify(
RoundTo(MathArcSin(0.00000003), 49)
, 0.3000000000000000450000000000000182250000000000098
)
);

Verify(
RoundTo(N(Sin(N(ArcSin(0.1234567)))), 49)
, 0.1234567
);

/* ArcSin(x) for x close to 1 */
KnownFailure(
Verify(
RoundTo(N( (1-Sin(N(ArcSin(1-10^(-25)))))*10^25), 25)
, 1
)
);

Verify(
RoundTo(N(ArcSin(N(Sin(1.234567)))), 49)
, 1.234567
);

Verify(
RoundTo(N(ArcCos(0.32)), 49)
, 1.2450668395002664599210017811073013636631665998753
);

Verify(
RoundTo(N(ArcTan(0.32)), 49)
, 0.3097029445424561999173808103924156700884366304804
);

Verify(
RoundTo(N(Cos(N(ArcCos(0.1234567)))), 49)
, 0.1234567
);

Verify(
RoundTo(N(ArcCos(N(Cos(1.234567)))), 49)
, 1.234567
);

Verify(
RoundTo(N(Tan(N(ArcTan(20)))), 46)	// large roundoff error on Tan() calculation due to subtraction from Pi/2 -- unavoidable loss of precision
, 20
);
KnownFailure(
Verify(
RoundTo(N(Tan(N(ArcTan(500000)))), 38)
, 500000
)
);

KnownFailure(
Verify(
RoundTo(N((Pi/2-ArcTan(N(Tan(N(Pi/2)-10^(-24)))))*10^24 ), 25)
, 1
)
);

/// special functions
Precision(20);	// let's be gentle

TestYacas(
Gamma(10.5)
, (654729075*Sqrt(Pi))/1024
);

TestYacas(
Gamma(9/2)
, (105*Sqrt(Pi))/16
);

TestYacas(
Gamma(-10.5)
, (-2048*Sqrt(Pi))/13749310575
);

TestYacas(
Gamma(-7/2)
, (16*Sqrt(Pi))/105
);

TestYacas(
RoundTo(N( GammaNum(10.5) ), 14)
, 1133278.38894878556733
);

TestYacas(
RoundTo(N( GammaNum(-11.5) ), 20)
, 0.00000002295758104824
);

TestYacas(
RoundTo(N( GammaNum(-12.5) ), 20)
, -0.00000000183660648386
);

TestYacas(	// lost 2 digits b/c of imprecise arithmetic
RoundTo(N( Zeta(-11.5) ), 18)
, 0.020396978715942792
);

TestYacas(
Zeta(40)
, (261082718496449122051*Pi^40)/20080431172289638826798401128390556640625
);

TestYacas(
Zeta(-11)
, 691/32760
);

TestYacas(
Zeta(-12)
, 0
);

TestYacas(
RoundTo(ZetaNum(40), 19)
, 1.0000000000009094948
);

TestYacas(
RoundTo(ZetaNum(1.5), 19)
, 2.6123753486854883433
);

TestYacas(
Bernoulli(40)
, -261082718496449122051/13530
);

Verify(
ContFracList(355/113)
, {3,7,16}
);

Verify(
ContFracList(-24, 4)
, {-24}
);

Verify(
ContFracList(-355/113)
, {-4,1,6,16}
);

Precision(7);

Verify(
GuessRational(N(Pi))
, 355/113
);
